<div class="row">
  <div class="row s12 center" ng-if="profile.webid" ng-hide="profile.webid && !profile.loading">
      <div class="row s12 center">
        <spinner class="white-text"></spinner>
      </div>
      <div class="row s12 white-text center">Loading profile...</div>
  </div>

  <div ng-if="profile.webid && !profile.loading" class="col s12">
    <!-- Top section -->
    <div class="row s12 m12 profile-large">
      <!-- Background -->
      <div class="btn change-bg white black-text valign-wrapper" ng-file-select accept="image/*" ng-multiple="false" ng-capture="camera" ng-model="bgFile.file">
        <spinner class="spinner right-10 left valign" ng-show="profile.bgpicture.uploading"></spinner>
        <div class="left valign">Change image</div>
      </div>
      <div pick-source obj="profile.bgpicture" ng-show="profile.bgpicture.picker"></div>
      <div class="grad-bg profile-large-bg center col s12">
          <div bg-image ng-if="profile.bgpicture.value" bg="profile.bgpicture"></div>
      </div>
      <!-- Avatar -->
      <div class="row s12">
        <div class="profile-large-avatar valign-wrapper center col s12 m4">
          <div ng-file-drop ng-model="pictureFile.file" class="drop-box valign-wrapper center profile-picture" 
              drag-over-class="dragover" ng-multiple="false" allow-dir="false"
              ng-accept="'.jpg,.jpeg,.png'" ng-capture="camera">
              <div ng-file-select ng-model="pictureFile.file" accept="image/*" ng-multiple="false" ng-capture="camera" class="relative center valign-wrapper">
                <div class="valign center valign-wrapper pick-file">
                  <spinner class="valign spinner" ng-show="profile.picture.uploading"></spinner>
                  <i class="mdi-image-camera-alt small white-text valign" ng-hide="uploading || profile.picture.locked"></i>
                  <span class="valign">Change photo</span>
                </div>
                <img ng-if="profile.picture.value" ng-src="{{profile.picture.value}}"/>
                <img ng-if="!profile.picture.value || profile.picture.value.length == 0" src="images/generic_photo.png">
              </div>
          </div>
          <div pick-source obj="profile.picture" ng-show="profile.picture.picker"></div>
        </div>
        <!-- Name -->
        <div class="profile-large-name right col s12 m8">
          <h4 class="">
            {{profile.fullname.value}}
          </h4>
          <div class="truncate"><i class="mdi-content-link valign right-10"></i><a href="{{profile.webid}}" class="black-text" target="_blank" title="{{profile.webid}}">{{profile.webid}}</a></div>
        </div>
      </div>
    </div>

    <div class="row card-panel">
      <div class="col s12 m8">
        <h4 class="valign-wrapper align-left"><i class="mdi-action-account-box valign right-10"></i>Name</h4>
      </div>
      <div class="col s12">
        <div class="input-field pad-right-10 col s12 m6">
          <input id="firstname" type="text" ng-model="profile.firstname.value" ng-blur="updateObject(profile.firstname)" ng-disabled="profile.firstname.locked">
          <label for="firstname" ng-class="{active: profile.firstname.value.length > 0}">First Name{{profile.firstname.locked?'...updating':''}}</label>
          <div pick-source obj="profile.firstname" ng-show="profile.firstname.picker"></div>
        </div>
        <div class="input-field pad-right-10 col s12 m3">
          <input id="lastname" type="text" ng-model="profile.lastname.value" ng-blur="updateObject(profile.lastname)" ng-disabled="profile.lastname.locked">
          <label for="lastname" ng-class="{active: profile.lastname.value.length > 0}">Last Name{{profile.lastname.locked?'...updating':''}}</label>
          <div pick-source obj="profile.lastname" ng-show="profile.lastname.picker"></div>
        </div>
        <div class="input-field col s12 m3">
          <input id="nick" type="text" ng-model="profile.nick.value" ng-blur="updateObject(profile.nick)" ng-disabled="profile.nick.locked">
          <label for="nick" ng-class="{active: profile.nick.value.length > 0}">Nickname{{profile.nick.locked?'...updating':''}}</label>
          <div pick-source obj="profile.nick" ng-show="profile.nick.picker"></div>
        </div>
        <div class="input-field col s12">
          <input id="fullname" type="text" ng-model="profile.fullname.value" ng-blur="updateObject(profile.fullname)" ng-disabled="profile.fullname.locked">
          <label for="fullname" ng-class="{active: profile.fullname.value.length > 0}">Full Name{{profile.fullname.locked?'...updating':''}}</label>
          <div pick-source obj="profile.fullname" ng-show="profile.fullname.picker"></div>
        </div>
      </div>
    </div>

    <div class="row card-panel">
      <div class="col s12">
        <h4 class="valign-wrapper align-left"><i class="mdi-communication-phone valign right-10"></i>Phone numbers</h4>
      </div>
      <div class="input-field col s12" ng-repeat="(id, phone) in profile.phones track by $index">
        <a class="prefix" ng-click="deletePhone(id)"><i class="mdi-action-delete"></i></a>
        <input id="telephone" type="tel" ng-model="phone.value" ng-change="space2dash(phone)" ng-blur="updateObject(phone)" ng-disabled="phone.locked">
        <label for="telephone" ng-class="{active: phone.value.length > 0}">Phone{{phone.locked?'...updating':''}}</label>
        <div pick-source obj="phone" ng-show="phone.picker"></div>
      </div>
      <div class="col s12">
        <a class="btn blue" ng-click="addPhone()"><i class="mdi-content-add left"></i>phone</a>
      </div>
    </div>

    <div class="row card-panel">
      <div class="col s12">
        <h4 class="valign-wrapper align-left"><i class="mdi-communication-email valign right-10"></i>Emails</h4>
      </div>
      <div class="input-field col s12" ng-repeat="(id, email) in profile.emails track by $index">
        <a class="prefix" ng-click="deleteEmail(id)"><i class="mdi-action-delete"></i></a>
        <input id="email" type="text" ng-model="email.value" ng-blur="updateObject(email)" ng-disabled="email.locked">
        <label for="email" ng-class="{active: email.value.length > 0}">Email{{email.locked?'...updating':''}}</label>
        <div pick-source obj="email" ng-show="email.picker"></div>
      </div>
      <div class="col s12">
          <a class="btn blue" ng-click="addEmail()"><i class="mdi-content-add left"></i>email</a>
      </div>
    </div>

    <div class="row card-panel">
      <div class="col s12">
        <h4 class="valign-wrapper align-left"><i class="mdi-maps-rate-review valign right-10"></i>Blogs</h4>
      </div>
      <div class="input-field col s12" ng-repeat="(id, blog) in profile.blogs track by $index">
        <a class="prefix" ng-click="deleteBlog(id)"><i class="mdi-action-delete"></i></a>
        <input id="blog" type="text" ng-model="blog.value" ng-blur="updateObject(blog)" ng-disabled="blog.locked">
        <label for="blog" ng-class="{active: blog.value.length > 0}">Blog{{blog.locked?'...updating':''}}</label>
        <div pick-source obj="blog" ng-show="blog.picker"></div>
      </div>
      <div class="col s12">
          <a class="btn blue" ng-click="addBlog()"><i class="mdi-content-add left"></i>blog</a>
      </div>
    </div>

    <div class="row card-panel">
      <div class="col s12">
        <h4 class="valign-wrapper align-left"><i class="mdi-social-public valign right-10"></i>Personal pages</h4>
      </div>
      <div class="input-field col s12" ng-repeat="(id, homepage) in profile.homepages track by $index">
        <a class="prefix" ng-click="deleteHomepage(id)"><i class="mdi-action-delete"></i></a>
        <input id="homepage" type="text" ng-model="homepage.value" ng-blur="updateObject(homepage)" ng-disabled="homepage.locked">
        <label for="homepage" ng-class="{active: homepage.value.length > 0}">Personal homepage{{homepage.locked?'...updating':''}}</label>
        <div pick-source obj="homepage" ng-show="homepage.picker"></div>
      </div>
      <div class="col s12">
        <a class="btn blue" ng-click="addHomepage()"><i class="mdi-content-add left"></i>homepage</a>
      </div>
    </div>

    <div class="row card-panel">
      <div class="col s12">
        <h4 class="valign-wrapper align-left"><i class="mdi-social-public valign right-10"></i>Work pages</h4>
      </div>
      <div class="input-field col s12" ng-repeat="(id, workpage) in profile.workpages track by $index">
        <a class="prefix" ng-click="deleteWorkpage(id)"><i class="mdi-action-delete"></i></a>
        <input id="workpage" type="text" ng-model="workpage.value" ng-blur="updateObject(workpage)" ng-disabled="workpage.locked">
        <label for="workpage" ng-class="{active: workpage.value.length > 0}">Work homepage{{workpage.locked?'...updating':''}}</label>
        <div pick-source obj="workpage" ng-show="workpage.picker"></div>
      </div>
      <div class="col s12">
        <a class="btn blue" ng-click="addWorkpage()"><i class="mdi-content-add left"></i>workpage</a>
      </div>
    </div>

  </div>
  
  <div ng-if="!profile.webid">
    <form>
      <div class="col s12">
        <div class="row center">
          <h4>Type a WebID or <a href="#/login" class="white-text show-link">login</a> to edit your profile.</h4>
        </div>
        <div class="row">
          <div class="input-field">
            <input id="profile" type="text" ng-model="form.webid">
            <label for="profile" class="white-text" ng-class="{active: form.webid.length > 0}">WebID</label>
          </div>
        </div>
        <div class="row center">
          <button class="btn blue" ng-click="editProfile()" type="submit">Edit</button>
        </div>
      </div>
    </form>
  </div>

  <div class="modal s12 m3" id="picture-cropper">
    <div class="modal-content">
      <div class="modal-body">
        <div class="col s12 m6 valign-wrapper">
          <div class="cropArea valign">
            <img-crop image="originalImage" area-type="square" result-image-format="{{imageType}}" result-image="croppedImage"></img-crop>
          </div>
        </div>
        <div class="col s12 m6 valign-wrapper">
          <img id="result-image" class="valign" ng-src="{{croppedImage}}" />
        </div>
      </div>
      <div class="modal-footer">
        <a href="#" class="blue white-text btn-flat modal-action modal-close">Cancel</a>
        <a href="#" class="blue white-text btn-flat modal-action modal-close right-10" ng-click="savePicture()">Save</a>
      </div>
    </div>
  </div>
</div>